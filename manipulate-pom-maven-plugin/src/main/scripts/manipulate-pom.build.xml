<project>
	<taskdef resource="net/sf/antcontrib/antlib.xml"/>
	<taskdef resource="org/apache/maven/ant/tasks/antlib.xml"/>
	<taskdef name="xmltask" classname="com.oopsconsultancy.xmltask.ant.XmlTask"/> 
	<taskdef name="change-pom-coordinates" classname="com.github.odavid.maven.plugins.ChangeCoordinatesAntTask"/>


	<target name="change-coordinates">
		<for param="pom">
			<path>
				<fileset dir="${workspaceDir}" includes="**/pom.xml" excludes="${excludes}"/>
			</path>
			<sequential>
				<change-coordinates-macro pom="@{pom}" backup="${backup}" from="${from}" to="${to}"/>
			</sequential>
		</for>		
	</target>

	<macrodef name="change-coordinates-macro">
		<attribute name="backup" default="false"/>
		<attribute name="pom"/>
		<attribute name="from"/>
		<attribute name="to"/>
		<sequential>
			<if>
				<istrue value="@{backup}"/>
				<then>
					<copy file="@{pom}" tofile="@{pom}.backup"/>
				</then>
			</if>
			<change-pom-coordinates pom="@{pom}" from="@{from}" to="@{to}"/>
		</sequential>
	</macrodef>	
</project>